zabbix_export:
  version: '5.2'
  date: '2021-02-15T13:50:22Z'
  groups:
    -
      name: GWs
  templates:
    -
      template: 'Pfsense IPSec tunnels'
      name: 'Pfsense IPSec tunnels'
      groups:
        -
          name: GWs
      applications:
        -
          name: IPSec
      discovery_rules:
        -
          name: 'IPSec Tunnel Discovery'
          key: ipsec.discover
          delay: '120'
          item_prototypes:
            -
              name: 'Bytes IN: {#DESCRIPTION} -  {#TUNNEL}'
              key: 'ipsec.traffic[{#TUNNEL},"bytesIn"]'
              delay: '120'
              history: 30d
              trends: 90d
              units: bytes
              applications:
                -
                  name: IPSec
            -
              name: 'Bytes OUT: {#DESCRIPTION} -  {#TUNNEL}'
              key: 'ipsec.traffic[{#TUNNEL},"bytesOut"]'
              delay: '120'
              history: 30d
              trends: 90d
              units: bytes
              applications:
                -
                  name: IPSec
            -
              name: 'PKTS IN: {#DESCRIPTION} -  {#TUNNEL}'
              key: 'ipsec.traffic[{#TUNNEL},"pktsIn"]'
              delay: '120'
              history: 30d
              trends: 90d
              units: pkts
              applications:
                -
                  name: IPSec
            -
              name: 'PKTS Out: {#DESCRIPTION} -  {#TUNNEL}'
              key: 'ipsec.traffic[{#TUNNEL},"pktsOut"]'
              delay: '120'
              history: 30d
              trends: 90d
              units: pkts
              applications:
                -
                  name: IPSec
            -
              name: 'Tunnel: {#DESCRIPTION} - {#TUNNEL}'
              key: 'ipsec.tunnel[{#TUNNEL}]'
              delay: '120'
              history: 30d
              trends: 90d
              applications:
                -
                  name: IPSec
              trigger_prototypes:
                -
                  expression: '{last(0)}<>0'
                  name: 'Tunnel: {#DESCRIPTION} - {#TUNNEL}  down'
                  priority: HIGH
                  tags:
                    -
                      tag: tunnel_name
                      value: '{#TUNNEL}'
                    -
                      tag: tunnel_state
                      value: down
          graph_prototypes:
            -
              name: '{#DESCRIPTION} - {#TUNNEL} Packages'
              graph_items:
                -
                  color: 2774A4
                  item:
                    host: 'Pfsense IPSec tunnels'
                    key: 'ipsec.traffic[{#TUNNEL},"pktsIn"]'
                -
                  sortorder: '1'
                  color: A54F10
                  item:
                    host: 'Pfsense IPSec tunnels'
                    key: 'ipsec.traffic[{#TUNNEL},"pktsOut"]'
            -
              name: '{#DESCRIPTION} - {#TUNNEL} Traffic'
              graph_items:
                -
                  color: F63100
                  item:
                    host: 'Pfsense IPSec tunnels'
                    key: 'ipsec.traffic[{#TUNNEL},"bytesIn"]'
                -
                  sortorder: '1'
                  color: 2774A4
                  item:
                    host: 'Pfsense IPSec tunnels'
                    key: 'ipsec.traffic[{#TUNNEL},"bytesOut"]'
            -
              name: '{#DESCRIPTION} status'
              graph_items:
                -
                  color: 1A7C11
                  item:
                    host: 'Pfsense IPSec tunnels'
                    key: 'ipsec.tunnel[{#TUNNEL}]'
